{% extends 'base.html'%}
{% load static %}
{% block content %}
<link rel="stylesheet" type="text/css" href="{% static 'css/analysis.css' %}">
<div id="main">
    <div id="main-box">
        <form action="{% url 'analysis' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div id="range-box">
                <p>youtube URLかファイル(mp3, wav)を選択</p>
                <label for="url-or-file">URL</label>
                <input type="range" name="url-or-file" id="url-or-file" min="0" max="1" step="1">
                <label for="url-or-file">ファイル</label>
            </div>

            <div id="file-box">
                <label for="id">ファイルを選択</label>
                <input type="file" name="soundfile" id="soundfile" required>
            </div>

            <div id="url-box" hidden>
                <label for="input-url" id="label">YouTube URL</label>
                <input type="text" name="input-url" id="input-url" placeholder="URLを入力" required>
                <div class="background-input-box"></div>
            </div>

            <div class="range-box">
                <p>ボーカルあり・なしを選択</p>
                <label for="vocal">ボーカルあり</label>
                <input type="range" name="vocal" id="vocal" min="0" max="1" step="1">
                <label for="vocal">ボーカルなし</label>
            </div>

            <div class="range-box">
                <p>楽器別(バス、ドラム、その他)に分けるか選択</p>
                <label for="separate">分けない</label>
                <input type="range" name="separate" id="separate" min="0" max="1" step="1">
                <label for="separate">分ける</label>
            </div>

            <div id="execution-box">
                <button type="submit">解析する</button>
            </div>
        </form>
    </div>
</div>
{% if user.is_authenticated %}
  <p>{{ user.username }} でログインしています/You are logged in as {{ user.username }}</p>
  <form method="post" action="{% url 'logout' %}">
    {% csrf_token %}
    <button type="submit">ログアウト/Login</button>
  </form>
  {% else %}
        <p>ログインしていません。/You are not logged in. Please <a href="{% url 'login' %}">ログイン/Login</a>.</p>
{% endif %}
<script>
    const urlBoxElement = document.getElementById("url-box");
    const fileBoxElement = document.getElementById("file-box");
    const urlOrFileRangeElement = document.getElementById("url-or-file");

    urlOrFileRangeElement.addEventListener("input", (e) => {
        if (e.target.value === "0") {
            urlBoxElement.hidden = false;
            fileBoxElement.hidden = true;
        } else {
            urlBoxElement.hidden = true;
            fileBoxElement.hidden = false;
        }
    })
</script>
{% endblock %}